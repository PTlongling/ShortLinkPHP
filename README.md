# 短链接系统安装和使用说明

## 系统概述

这是一个功能完整的短链接生成系统，支持用户注册、登录、人机验证，以及不同等级用户的链接数量和时间限制。系统包含管理员后台管理功能，支持用户封禁和链接管理。

## 系统要求

- Web服务器（Apache/Nginx）
- PHP 7.4 或更高版本
- MySQL 5.7 或更高版本
- 宝塔面板（推荐）

## 安装步骤

### 1. 环境准备

1. 确保服务器已安装宝塔面板
2. 通过宝塔面板创建网站和MySQL数据库
3. 记下数据库名称、用户名和密码

### 2. 上传文件

将以下文件上传到网站根目录：

```
网站根目录/
├── classes/
│   └── Database.php
├── index.php
├── install.php
├── config.php (安装后自动生成)
├── login.php
├── register.php
├── logout.php
├── dashboard.php
├── profile.php
├── admin.php
├── banned.php
├── free.php
├── hvip.php
├── expired.php
├── disabled.php
├── error-404.php
├── showban.php
├── renew_link.php
├── delete_link.php
├── about.php
└── contact.php (可选)
```

### 3. 运行安装程序

1. 通过浏览器访问您的域名：`http://您的域名/install.php`
2. 按照提示填写数据库信息：
   - 数据库主机：通常为 `localhost`
   - 数据库名：您在宝塔面板创建的数据库名称
   - 数据库用户名：数据库用户名
   - 数据库密码：数据库密码
3. 设置管理员账户信息：
   - 管理员用户名
   - 管理员邮箱
   - 管理员密码
4. 点击"安装"按钮完成安装

### 4. 完成安装

安装完成后：
1. 系统会自动创建配置文件 `config.php`
2. 自动创建所有必要的数据库表
3. 创建管理员账户
4. 删除或重命名 `install.php` 文件以确保安全

## 使用 phpMyAdmin 修改数据表

### 添加 redirect_delay 字段

1. 登录宝塔面板，打开phpMyAdmin
2. 选择您的数据库
3. 点击SQL标签，执行以下命令：

```sql
ALTER TABLE users ADD redirect_delay INT NOT NULL DEFAULT 3 COMMENT '跳转等待时间（1-10秒）';
```

或者通过界面操作：
1. 点击"users"表
2. 点击"结构"标签
3. 滚动到底部，点击"添加"（添加1个字段）
4. 填写字段信息：
   - 名称：`redirect_delay`
   - 类型：`INT`
   - 默认：`3`
   - 注释：`跳转等待时间（1-10秒）`
5. 点击"保存"

### 为现有用户设置默认值

如果用户表中已有数据，执行以下SQL：

```sql
UPDATE users SET redirect_delay = 3 WHERE redirect_delay IS NULL OR redirect_delay = 0;
```

## 系统功能说明

### 用户等级和权限

1. **免费用户 (Free)**
   - 最多创建10个短链接
   - 链接有效期30天
   - 跳转前需等待5秒（正常配色页面）
   - 无法使用自定义后缀功能

2. **高级用户 (Premium)**
   - 最多创建100个短链接
   - 链接有效期365天
   - 可自定义跳转等待时间（1-10秒）
   - 可使用自定义后缀功能
   - 享受鎏金配色跳转页面

3. **管理员 (Admin)**
   - 最多创建1000个短链接
   - 链接有效期10年
   - 拥有所有高级用户功能
   - 可以管理所有用户和链接
   - 可以封禁/解封用户

### 主要页面功能

1. **首页 (index.php)**
   - 生成短链接
   - 显示用户等级和功能对比
   - 导航到其他功能页面

2. **控制台 (dashboard.php)**
   - 管理已创建的短链接
   - 查看链接点击统计
   - 续期过期链接（24小时内）

3. **个人中心 (profile.php)**
   - 查看和修改账户信息
   - 修改密码
   - 高级用户可设置跳转等待时间

4. **管理员后台 (admin.php)**
   - 管理所有短链接
   - 启用/禁用/删除链接

5. **用户封禁管理 (banned.php)**
   - 查看所有用户
   - 封禁/解封用户

6. **关于页面 (about.php)**
   - 系统介绍和功能说明
   - 团队信息和用户评价

### 特殊页面

1. **免费用户跳转页面 (free.php)**
   - 正常配色设计
   - 固定5秒等待时间
   - 显示目标网站和短链接首页信息

2. **高级用户跳转页面 (hvip.php)**
   - 鎏金配色设计
   - 可自定义等待时间（1-10秒）
   - 显示目标网站和短链接首页信息

3. **错误页面**
   - 404页面 (error-404.php)：短链接不存在
   - 过期页面 (expired.php)：链接已过期
   - 禁用页面 (disabled.php)：链接已被禁用
   - 封禁页面 (showban.php)：用户已被封禁

## 日常维护

### 数据库备份
1. 定期通过宝塔面板备份数据库
2. 或使用phpMyAdmin导出功能

### 系统更新
1. 备份当前系统和数据库
2. 上传新版本文件
3. 检查并更新数据库结构（如有需要）
4. 测试所有功能

### 故障排除

常见问题及解决方案：

1. **数据库连接错误**
   - 检查config.php中的数据库配置
   - 确认数据库服务正常运行

2. **页面显示错误**
   - 检查PHP错误日志
   - 确认所有文件已正确上传

3. **功能不正常**
   - 检查数据库表结构是否完整
   - 确认文件权限设置正确

## 安全建议

1. 定期更改数据库密码
2. 保持系统和软件更新
3. 限制管理员账户访问
4. 定期检查系统日志
5. 使用HTTPS加密连接

## 技术支持

如果您遇到问题：
1. 首先检查宝塔面板的错误日志
2. 检查PHP错误日志
3. 确认所有步骤已正确执行
4. 如需进一步帮助，请踢几脚

---

